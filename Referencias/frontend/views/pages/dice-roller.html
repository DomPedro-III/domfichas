<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rolagem de Dados - DomFichas</title>
    <link rel="stylesheet" href="../../public/css/style.css">
    <link rel="stylesheet" href="../../public/css/responsive.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">
            <h2>üé≤ DomFichas</h2>
        </div>
        
        <div class="nav-links">
            <a href="dashboard.html" class="nav-link">‚Üê Voltar ao Dashboard</a>
            <span class="user-welcome">Ol√°, <span id="userName" class="user-name"></span>!</span>
            <button id="logoutBtn" class="btn btn-outline">Sair</button>
        </div>
    </nav>

    <div class="container">
        <header class="dice-header">
            <h1>Rolagem de Dados</h1>
            <p>Sistema de rolagem integrado com hist√≥rico</p>
        </header>

        <div class="dice-container">
            <!-- Resultado da Rolagem -->
            <div class="dice-result">
                <div class="dice-value" id="diceResult">--</div>
                <p class="dice-type" id="diceType">Clique em um dado para rolar</p>
            </div>

            <!-- Controles de Dados -->
            <div class="dice-controls">
                <button class="dice-btn" data-dice="4">d4</button>
                <button class="dice-btn" data-dice="6">d6</button>
                <button class="dice-btn" data-dice="8">d8</button>
                <button class="dice-btn" data-dice="10">d10</button>
                <button class="dice-btn" data-dice="12">d12</button>
                <button class="dice-btn" data-dice="20">d20</button>
                <button class="dice-btn" data-dice="100">d100</button>
            </div>

            <!-- Rolagem Customizada -->
            <div class="custom-roll">
                <h3>Rolagem Customizada</h3>
                <div class="custom-controls">
                    <div class="form-group">
                        <label for="customDice">Quantidade de Dados</label>
                        <input type="number" id="customDice" value="1" min="1" max="10">
                    </div>
                    <div class="form-group">
                        <label for="customSides">Lados do Dado</label>
                        <input type="number" id="customSides" value="6" min="2" max="100">
                    </div>
                    <div class="form-group">
                        <label for="customModifier">Modificador</label>
                        <input type="number" id="customModifier" value="0">
                    </div>
                    <button id="customRollBtn" class="btn btn-primary">Rolar Customizado</button>
                </div>
            </div>
        </div>

        <!-- Hist√≥rico de Rolagens -->
        <div class="history-section">
            <h3>üìú Hist√≥rico de Rolagens</h3>
            <div class="history-controls">
                <button id="clearHistory" class="btn btn-outline">Limpar Hist√≥rico</button>
                <button id="exportHistory" class="btn btn-outline">Exportar</button>
            </div>
            <div class="history-list" id="historyList">
                <div class="empty-history">
                    <p>Nenhuma rolagem realizada ainda</p>
                </div>
            </div>
        </div>
    </div>

    <div id="message" class="message hidden"></div>

    <script src="../../public/js/utils/Helpers.js"></script>
    <script src="../../public/js/models/User.js"></script>
    <script src="../../public/js/views/AuthView.js"></script>
    <script src="../../public/js/views/DiceView.js"></script>
    <script src="../../public/js/controllers/AuthController.js"></script>
    <script src="../../public/js/controllers/DiceController.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const authController = new AuthController();
            const diceController = new DiceController();
            
            // Carregar dados do usu√°rio
            const user = authController.getCurrentUser();
            if (user) {
                document.getElementById('userName').textContent = user.user;
            }
            
            // Carregar hist√≥rico
            diceController.loadHistory();
            
            // Configurar eventos
            document.querySelectorAll('.dice-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const sides = parseInt(e.target.dataset.dice);
                    diceController.rollDice(sides);
                });
            });
            
            document.getElementById('customRollBtn').addEventListener('click', () => {
                const diceCount = parseInt(document.getElementById('customDice').value);
                const sides = parseInt(document.getElementById('customSides').value);
                const modifier = parseInt(document.getElementById('customModifier').value);
                diceController.rollCustom(diceCount, sides, modifier);
            });
            
            document.getElementById('clearHistory').addEventListener('click', () => {
                diceController.clearHistory();
            });
            
            document.getElementById('exportHistory').addEventListener('click', () => {
                diceController.exportHistory();
            });
            
            document.getElementById('logoutBtn').addEventListener('click', () => {
                authController.logout();
            });
        });
    </script>
</body>
</html>